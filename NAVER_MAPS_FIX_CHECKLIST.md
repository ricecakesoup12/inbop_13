# ë„¤ì´ë²„ ì§€ë„ API ì¸ì¦ ë¬¸ì œ í•´ê²° ì²´í¬ë¦¬ìŠ¤íŠ¸ âœ…

## âœ… ì™„ë£Œëœ ì‘ì—…

### 1. `loadNaverMap.ts` - ì¸ì¦ ì‹¤íŒ¨ ê°€ë“œ ì¶”ê°€
- âœ… ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ í›„ `window.naver?.maps` ì¡´ì¬ í™•ì¸
- âœ… ì¸ì¦ ì‹¤íŒ¨ ì‹œ `NAVER_MAPS_AUTH_FAILED` ì—ëŸ¬ throw

### 2. `vite.config.ts` - í¬íŠ¸ ê³ ì •
- âœ… `host: 'localhost'` ì¶”ê°€
- âœ… `port: 5173` ê³ ì •

### 3. `GuardianAllUsersMap.vue` - ì•ˆì „ì¥ì¹˜ ê°•í™”
- âœ… ì§€ë„ ì´ˆê¸°í™” ì „ `window.naver?.maps` ê²€ì¦
- âœ… ì¢Œí‘œ ê²€ì¦ ì¶”ê°€ (`isFinite` ì²´í¬)
- âœ… í•œêµ­ ì§€ì—­ ë²”ìœ„ ê²€ì¦ (ê²½ê³ ë§Œ)
- âœ… ì§€ë„ ìƒì„± ì‹œ try-catchë¡œ ì•ˆì „ ì²˜ë¦¬

### 4. `LiveMap.vue` - ì•ˆì „ì¥ì¹˜ ê°•í™”
- âœ… ì§€ë„ ì´ˆê¸°í™” ì „ `window.naver?.maps` ê²€ì¦
- âœ… ì¢Œí‘œ ê²€ì¦ ì¶”ê°€ (`isFinite` ì²´í¬)
- âœ… ë‹¤ë¥¸ ì‚¬ìš©ì ìœ„ì¹˜ í‘œì‹œ ì‹œ ì¢Œí‘œ ê²€ì¦
- âœ… ì§€ë„ ìƒì„± ì‹œ try-catchë¡œ ì•ˆì „ ì²˜ë¦¬

---

## ğŸ“‹ ë„¤ì´ë²„ í´ë¼ìš°ë“œ í”Œë«í¼ ì„¤ì • (ìˆ˜ë™ ì‘ì—… í•„ìš”)

### 1. ì„œë¹„ìŠ¤ URL ë“±ë¡

1. [ë„¤ì´ë²„ í´ë¼ìš°ë“œ í”Œë«í¼ ì½˜ì†”](https://console.naver.com/ncloud/application) ì ‘ì†
2. **AIÂ·NAVER API > Application > ë‚´ ì• í”Œë¦¬ì¼€ì´ì…˜** ì„ íƒ
3. **Maps íƒ­** í´ë¦­
4. **ì„œë¹„ìŠ¤ í™˜ê²½ > Web Dynamic Map** ì„¹ì…˜ì—ì„œ
5. **Service URL(Referer)**ì— ë‹¤ìŒ **ëª¨ë‘** ì¶”ê°€:
   ```
   http://localhost:5173
   http://127.0.0.1:5173
   ```
   (ë°°í¬ ì‹œì—ëŠ” `https://your-domain.com`ë„ ì¶”ê°€)

6. **ì €ì¥** í´ë¦­
7. **1~2ë¶„ ëŒ€ê¸°** (ì„¤ì • ì „íŒŒ ì‹œê°„)

### 2. í´ë¼ì´ì–¸íŠ¸ ID í™•ì¸

- í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ í´ë¼ì´ì–¸íŠ¸ ID: `9qiIZYGa6W8yzC7LxqOzNjld12ap71PgHBpWSsZ6`
- **ì‹ ê·œ Web Dynamic Map** í´ë¼ì´ì–¸íŠ¸ ID ì‚¬ìš© ê¶Œì¥ (ê³µì§€ì‚¬í•­ ì°¸ê³ )

---

## ğŸ” ì½”ë“œ ê²€ì¦ í¬ì¸íŠ¸

### âœ… `loadNaverMap.ts`
```typescript
return loadPromise.then(() => {
  // ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ í›„ ìµœì¢… ê²€ì¦
  if (!('naver' in window) || !(window as any).naver?.maps) {
    console.error('âŒ ë„¤ì´ë²„ ì§€ë„ ì¸ì¦ ì‹¤íŒ¨ ë˜ëŠ” API ë¯¸ì´ˆê¸°í™”');
    throw new Error('NAVER_MAPS_AUTH_FAILED');
  }
  return Promise.resolve();
});
```

### âœ… ì§€ë„ ì»´í¬ë„ŒíŠ¸ë“¤
```typescript
// ì§€ë„ ì´ˆê¸°í™” ì „ ê²€ì¦
if (!('naver' in window) || !(window as any).naver?.maps) {
  console.error('âŒ ë„¤ì´ë²„ ì§€ë„ ì¸ì¦ ì‹¤íŒ¨: í´ë¼ì´ì–¸íŠ¸ID/ì„œë¹„ìŠ¤URLì„ í™•ì¸í•˜ì„¸ìš”.');
  // ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ
  return;
}

const nmaps = (window as any).naver.maps;

// ì§€ë„ ìƒì„± ì‹œ ì•ˆì „ ì²˜ë¦¬
try {
  if (!nmaps || !nmaps.Map || !nmaps.LatLng) {
    throw new Error('ë„¤ì´ë²„ ì§€ë„ API ê°ì²´ê°€ ì™„ì „íˆ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
  }
  map.value = new nmaps.Map(mapElement, { /* ... */ });
} catch (mapError) {
  // ì—ëŸ¬ ì²˜ë¦¬
}
```

### âœ… ì¢Œí‘œ ê²€ì¦
```typescript
// ì¢Œí‘œ ê²€ì¦: NaN ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•Šì€ ì¢Œí‘œ ë°©ì§€
const lat = Number(location.latitude);
const lng = Number(location.longitude);

if (!isFinite(lat) || !isFinite(lng)) {
  console.warn(`âš ï¸ ì˜ëª»ëœ ì¢Œí‘œ ë¬´ì‹œ: userId=${location.userId}`);
  return; // ì˜ëª»ëœ ì¢Œí‘œëŠ” ê±´ë„ˆëœ€
}

const latlng = new nmaps.LatLng(lat, lng);
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ë°©ë²•

### 1. ì¸ì¦ ì„±ê³µ í™•ì¸
- ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ë‹¤ìŒ ë©”ì‹œì§€ í™•ì¸:
  ```
  âœ… ë„¤ì´ë²„ ì§€ë„ API ì´ˆê¸°í™” ì™„ë£Œ!
  âœ… ì§€ë„ ìƒì„± ì™„ë£Œ
  ```

### 2. ì¸ì¦ ì‹¤íŒ¨ í™•ì¸
- ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ë‹¤ìŒ ë©”ì‹œì§€ í™•ì¸:
  ```
  âŒ ë„¤ì´ë²„ ì§€ë„ ì¸ì¦ ì‹¤íŒ¨: í´ë¼ì´ì–¸íŠ¸ID/ì„œë¹„ìŠ¤URLì„ í™•ì¸í•˜ì„¸ìš”.
  ```
- ì§€ë„ ì˜ì—­ì— ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œë¨

### 3. ì¢Œí‘œ ê²€ì¦ í™•ì¸
- ì˜ëª»ëœ ì¢Œí‘œê°€ ë“¤ì–´ì˜¤ë©´ ì½˜ì†”ì— ê²½ê³  ì¶œë ¥:
  ```
  âš ï¸ ì˜ëª»ëœ ì¢Œí‘œ ë¬´ì‹œ: userId=1, lat=NaN, lng=undefined
  ```

---

## ğŸš¨ ì£¼ì˜ì‚¬í•­

1. **ë„¤ì´ë²„ í´ë¼ìš°ë“œ ì„¤ì • ë³€ê²½ í›„ ë°˜ë“œì‹œ 1~2ë¶„ ëŒ€ê¸°**
2. **ê°œë°œ ì„œë²„ ì¬ì‹œì‘ í•„ìš”** (`npm run dev`)
3. **ë¸Œë¼ìš°ì € ìºì‹œ ì‚­ì œ** (`Ctrl + Shift + R`)
4. **ì‹ ê·œ Web Dynamic Map API ì‚¬ìš© ê¶Œì¥** (ê¸°ì¡´ AI NAVER API ì¢…ë£Œ ì˜ˆì •)

---

## ğŸ“ ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡

1. âœ… `Exercise/main/src/utils/loadNaverMap.ts` - ì¸ì¦ ê²€ì¦ ì¶”ê°€
2. âœ… `Exercise/main/vite.config.ts` - í¬íŠ¸ ê³ ì •
3. âœ… `Exercise/main/src/components/map/GuardianAllUsersMap.vue` - ì•ˆì „ì¥ì¹˜ ê°•í™”
4. âœ… `Exercise/main/src/pages/user/LiveMap.vue` - ì•ˆì „ì¥ì¹˜ ê°•í™”

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

1. **ë„¤ì´ë²„ í´ë¼ìš°ë“œ ì½˜ì†”ì—ì„œ ì„œë¹„ìŠ¤ URL ë“±ë¡** (ìœ„ 1ë²ˆ ì°¸ê³ )
2. **ê°œë°œ ì„œë²„ ì¬ì‹œì‘**: `npm run dev`
3. **ë¸Œë¼ìš°ì €ì—ì„œ í…ŒìŠ¤íŠ¸**: `http://localhost:5173`
4. **ì½˜ì†” ë¡œê·¸ í™•ì¸**: ì—ëŸ¬ ì—†ì´ ì§€ë„ê°€ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

---

**ì‘ì„±ì¼**: 2025ë…„ 11ì›” 5ì¼  
**ìƒíƒœ**: âœ… ì½”ë“œ ìˆ˜ì • ì™„ë£Œ, ë„¤ì´ë²„ í´ë¼ìš°ë“œ ì„¤ì • í•„ìš”

